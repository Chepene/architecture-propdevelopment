# Список требований для внешних интеграций

## Взаимодействие между системами предприятия и внешней платформой


### Синхронные запросы от `tenant-core-app`:

`tenant-core-app` будет взаимодействовать с партнерским сервисов "Умный домофон" и "Умный шлагбаум", используя синхронные HTTP-запросы. Соединение будет защищено VPN-туннелем.

### Стриминг видео

* Пользователь в мобильном приложении PropDevelopment нажимает "Посмотреть видео"
* `tenant-core-app` отправляет запрос в API партнёра: "Создать WebRTC-сессию"
* Партнёр возвращает WebRTC SDP (Session Description Protocol)
* Мобильное приложение устанавливает WebRTC-соединение напрямую с сервером партнёра
* Видео идёт мимо серверов PropDevelopment – напрямую из партнера к мобильному приложению


## Протоколы аутентификации и авторизации

OAuth 2.0 (Client Credentials Flow) + JWT

* PropDevelopment отправляет запрос на OAuth-сервер партнёра с client_id и client_secret
* Партнёр выдаёт токен (JWT или Bearer), ограниченный по времени
* PropDevelopment использует этот токен для вызова API партнёра
* Периодически токен обновляется, если срок действия истёк


## Требования к безопасности

### Обработка и хранения данных

* Биометрические данные и номера автомобилей не хранятся в PropDevelopment – вся обработка происходит на стороне партнёра
* Минимизация передачи данных – партнёрская система должна получать только минимально необходимую информацию для выполнения операций
* Защита персональных данных – персональные данные должны передаваться и храниться в соответствии с ФЗ-152 (например, биометрия, номера машин)

### Передача данных по сети

* Шифрование данных – все передаваемые данные должны быть зашифрованы 
* Доступ к API только через VPN – все запросы от партнёров должны идти через защищённый VPN-туннель, исключая публичный доступ
* Использование межсетевого экрана (МЗТ, firewall) – на уровне сети и API должен быть firewall, который разрешает входящие соединения только через VPN.
* Регулярное сканирование VPN-инфраструктуры на уязвимости – VPN-серверы должны проходить аудит безопасности.
* Ограничение частоты запросов (Rate Limiting) – должны быть настроены лимиты на API-запросы, чтобы предотвратить DDoS-атаки

### Мониторинг и логирование

* Мониторинг доступности сервисов – должны использоваться метрики и алерты, проверяющие статус интеграции в режиме реального времени.
* Мониторинг аномальной активности – фиксировать подозрительные запросы (например, массовые проверки доступа) и реагировать на них.
* Журналирование подключений через VPN – все входы, выходы и запросы логируются с фиксацией IP, времени и типа запроса
* Журналирование всех операций – каждый запрос к партнерам должен логироваться с указанием источника запроса, времени, результата и ID пользователя 
* Журналы не содержат чувствительных данных

### Контроль доступа

* Контроль доступа – интеграции должны работать по принципу наименьших привилегий
* Система отзыва доступа в реальном времени – если пользователь отзывает согласие на обработку данных, PropDevelopment немедленно перестаёт отправлять запросы на партнёрский сервис.

